# Repository Guidelines

## Структура проекта
- Основной драйвер: `MTS4x.h` и `MTS4x.cpp` с классом `MTS4X`, вспомогательными ошибками и настройкой I2C; метаданные в `library.properties`, даташит `C19284877.pdf`.
- Примеры в `examples/`: `MTS4x_FullDemo` (последовательный вывод и настройка регистров), `MTS4x_MeteoStation` (Wi-Fi/JSON телеметрия).
- Новые материалы (схемы, скриншоты) кладите рядом с примерами; не коммитьте сборочные артефакты Arduino IDE.

## Сборка и запуск
- Поиск плат/портов: `arduino-cli board list`.
- Сборка ESP32 DevKit: `arduino-cli compile --fqbn esp32:esp32:esp32doit-devkit-v1 examples/MTS4x_FullDemo`.
- Сборка Uno/Nano: `arduino-cli compile --fqbn arduino:avr:uno examples/MTS4x_FullDemo`.
- Заливка: `arduino-cli upload --fqbn esp32:esp32:esp32doit-devkit-v1 --port COM3 examples/MTS4x_FullDemo` (замените FQBN/порт под свою плату).
- Для MeteoStation задайте SSID/PASS в скетче (или локальном `secrets.h`) перед сборкой.

## Стиль и именование
- C++ для Arduino, отступ 4 пробела, фигурные по K&R, методы `camelCase`; константы/enum в `ALL_CAPS`, приватные поля с `_` (например, `_lastError`).
- Используйте фиксированные типы (`uint8_t`, `uint16_t`), избегайте динамики; следуйте текущим путям ошибок (`lastError()`, `setError()`).
- Частота I2C явно (`busClock` по умолчанию 400 кГц); новые вызовы оборачивайте проверкой кода возврата.

## Тестирование
- Автотестов нет: проверяйте на железе оба скетча.
- FullDemo: включите CRC, убедитесь в диапазонах чтений и срабатывании тревог.
- MeteoStation: проверьте подключение к Wi-Fi, корректность JSON и период выборки.
- В тест-заметках фиксируйте плату/FQBN, вариант датчика (MTS4/MTS4Z/MTS4P/MTS4B) и распиновку.

## Коммиты и PR
- Короткие императивные сообщения (например, `Добавить усреднение для MTS4Z`).
- В PR опишите мотивацию, целевую плату и датчик; приложите логи/скриншоты ожидаемого вывода.
- При изменении публичного поведения или регистров обновляйте README/комментарии в примерах и поясняйте новые флаги.

## Безопасность и конфигурация
- Не коммитьте Wi-Fi креды; храните их в локальном `secrets.h` (добавьте в .gitignore).
- Проверяйте адрес I2C и подтяжки в примерах; любые нестандартные подключения описывайте в документации.
