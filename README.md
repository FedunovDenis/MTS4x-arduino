# MTS4x Arduino Library

РџРѕР»РЅРѕС„СѓРЅРєС†РёРѕРЅР°Р»СЊРЅР°СЏ Arduino-Р±РёР±Р»РёРѕС‚РµРєР° РґР»СЏ РІС‹СЃРѕРєРѕС‚РѕС‡РЅС‹С… С†РёС„СЂРѕРІС‹С… РґР°С‚С‡РёРєРѕРІ С‚РµРјРїРµСЂР°С‚СѓСЂС‹ СЃРµРјРµР№СЃС‚РІР° **MTS4**  
(**MTS4 / MTS4Z / MTS4P / MTS4B**, РІРєР»СЋС‡Р°СЏ РјРѕРґСѓР»СЊ **MTS4P+T4**), СЃ РїРѕРґРґРµСЂР¶РєРѕР№ **ESP8266**, **ESP32** Рё РєР»Р°СЃСЃРёС‡РµСЃРєРёС… РїР»Р°С‚ Arduino.

- Р”РёР°РїР°Р·РѕРЅ РёР·РјРµСЂРµРЅРёР№ (РІРЅСѓС‚СЂРµРЅРЅСЏСЏ РјРѕРґРµР»СЊ С‡РёРїР°): РїСЂРёРјРµСЂРЅРѕ **в€’103вЂ¦+153 В°C**
- Р Р°Р·СЂРµС€РµРЅРёРµ: **16 Р±РёС‚**, С€Р°Рі **0.004 В°C**
- РњР°РєСЃРёРјР°Р»СЊРЅР°СЏ С‚РѕС‡РЅРѕСЃС‚СЊ: РґРѕ **В±0.1 В°C** РІ В«РѕРєРЅРµ РІС‹СЃРѕРєРѕР№ С‚РѕС‡РЅРѕСЃС‚РёВ» (Р·Р°РІРёСЃРёС‚ РѕС‚ РјРѕРґРµР»Рё)
- Р РµР¶РёРјС‹: single-shot Рё continuous, РЅР°СЃС‚СЂР°РёРІР°РµРјС‹Рµ MPS Рё AVG
- Р’РѕР·РјРѕР¶РЅРѕСЃС‚Рё: CRC, TH/TL, Alert_Mode, heater, user-СЂРµРіРёСЃС‚СЂС‹, EВІPROM, РїР°СЂР°Р·РёС‚РЅРѕРµ РїРёС‚Р°РЅРёРµ
- РџР»Р°С‚С„РѕСЂРјС‹: ESP8266, ESP32, AVR (Uno/Nano/Mega) Рё РґСЂСѓРіРёРµ Arduino-СЃРѕРІРјРµСЃС‚РёРјС‹Рµ РїР»Р°С‚С‹

РџСЂРёРјРµСЂС‹ РІРєР»СЋС‡Р°СЋС‚:

- РџРѕР»РЅС‹Р№ Serial-РґРµРјРѕ: `MTS4x_FullDemo`
- Wi-Fi РјРµС‚РµРѕСЃС‚Р°РЅС†РёСЋ СЃ РјР°РєСЃРёРјР°Р»СЊРЅРѕР№ С‚РѕС‡РЅРѕСЃС‚СЊСЋ Рё JSON-API: `MTS4x_MeteoStation`

---

## РћРіР»Р°РІР»РµРЅРёРµ

1. [РћСЃРѕР±РµРЅРЅРѕСЃС‚Рё](#РѕСЃРѕР±РµРЅРЅРѕСЃС‚Рё)  
2. [РџРѕРґРґРµСЂР¶РёРІР°РµРјС‹Рµ РґР°С‚С‡РёРєРё](#РїРѕРґРґРµСЂР¶РёРІР°РµРјС‹Рµ-РґР°С‚С‡РёРєРё)  
3. [РџРѕРґРґРµСЂР¶РёРІР°РµРјС‹Рµ РїР»Р°С‚С„РѕСЂРјС‹](#РїРѕРґРґРµСЂР¶РёРІР°РµРјС‹Рµ-РїР»Р°С‚С„РѕСЂРјС‹)  
4. [РЈСЃС‚Р°РЅРѕРІРєР°](#СѓСЃС‚Р°РЅРѕРІРєР°)  
5. [РџРѕРґРєР»СЋС‡РµРЅРёРµ (СЃС…РµРјС‹ Рё С‚Р°Р±Р»РёС†С‹)](#РїРѕРґРєР»СЋС‡РµРЅРёРµ-СЃС…РµРјС‹-Рё-С‚Р°Р±Р»РёС†С‹)  
6. [Р‘С‹СЃС‚СЂС‹Р№ СЃС‚Р°СЂС‚](#Р±С‹СЃС‚СЂС‹Р№-СЃС‚Р°СЂС‚)  
7. [РџСЂРёРјРµСЂС‹ РёР· Р±РёР±Р»РёРѕС‚РµРєРё](#РїСЂРёРјРµСЂС‹-РёР·-Р±РёР±Р»РёРѕС‚РµРєРё)  
8. [Р РµС†РµРїС‚С‹ РёСЃРїРѕР»СЊР·РѕРІР°РЅРёСЏ](#СЂРµС†РµРїС‚С‹-РёСЃРїРѕР»СЊР·РѕРІР°РЅРёСЏ)  
9. [РћР±Р·РѕСЂ API РєР»Р°СЃСЃР° MTS4X](#РѕР±Р·РѕСЂ-api-РєР»Р°СЃСЃР°-mts4x)  
10. [Р РµР¶РёРј РјР°РєСЃРёРјР°Р»СЊРЅРѕР№ С‚РѕС‡РЅРѕСЃС‚Рё РґР»СЏ РјРµС‚РµРѕСЃС‚Р°РЅС†РёРё](#СЂРµР¶РёРј-РјР°РєСЃРёРјР°Р»СЊРЅРѕР№-С‚РѕС‡РЅРѕСЃС‚Рё-РґР»СЏ-РјРµС‚РµРѕСЃС‚Р°РЅС†РёРё)  
11. [РџСЂР°РєС‚РёС‡РµСЃРєРёРµ СЂРµРєРѕРјРµРЅРґР°С†РёРё](#РїСЂР°РєС‚РёС‡РµСЃРєРёРµ-СЂРµРєРѕРјРµРЅРґР°С†РёРё)  
12. [Р Р°Р·РІРѕРґРєР° Рё EMC](#СЂР°Р·РІРѕРґРєР°-Рё-emc)  
13. [РўРёРїРёС‡РЅС‹Рµ РѕС€РёР±РєРё Рё РґРёР°РіРЅРѕСЃС‚РёРєР°](#С‚РёРїРёС‡РЅС‹Рµ-РѕС€РёР±РєРё-Рё-РґРёР°РіРЅРѕСЃС‚РёРєР°)  
14. [Р Р°Р±РѕС‚Р° СЃ EВІPROM](#СЂР°Р±РѕС‚Р°-СЃ-eВІprom)  
15. [РџРѕСЂРѕРіРё Рё Р°РІР°СЂРёР№РЅС‹Рµ СЃРёРіРЅР°Р»С‹](#РїРѕСЂРѕРіРё-Рё-Р°РІР°СЂРёР№РЅС‹Рµ-СЃРёРіРЅР°Р»С‹)  
16. [РџР°СЂР°Р·РёС‚РЅРѕРµ РїРёС‚Р°РЅРёРµ](#РїР°СЂР°Р·РёС‚РЅРѕРµ-РїРёС‚Р°РЅРёРµ)  
17. [Changelog](#changelog)  
18. [License](#license)  
19. [English summary (short)](#english-summary-short)  

---

## РћСЃРѕР±РµРЅРЅРѕСЃС‚Рё

### Р”РёР°РїР°Р·РѕРЅ Рё СЂР°Р·СЂРµС€РµРЅРёРµ

- Р’РЅСѓС‚СЂРµРЅРЅРёР№ РґРёР°РїР°Р·РѕРЅ РёР·РјРµСЂРёС‚РµР»СЏ С‚РµРјРїРµСЂР°С‚СѓСЂС‹: РїСЂРёРјРµСЂРЅРѕ **в€’103вЂ¦+153 В°C**
- Р¤РѕСЂРјР°С‚ СЂРµР·СѓР»СЊС‚Р°С‚Р°: 16-Р±РёС‚РЅС‹Р№, С€Р°Рі **0.004 В°C/LSB**

### РўРѕС‡РЅРѕСЃС‚СЊ

Р—Р°РІРёСЃРёС‚ РѕС‚ РєРѕРЅРєСЂРµС‚РЅРѕРіРѕ РІР°СЂРёР°РЅС‚Р° MTS4:

- **MTS4P**: РґРѕ В±0.1 В°C РІ РґРёР°РїР°Р·РѕРЅРµ РїСЂРёРјРµСЂРЅРѕ в€’25вЂ¦+25 В°C  
- **MTS4Z**: РґРѕ В±0.1 В°C РІ РґРёР°РїР°Р·РѕРЅРµ РїСЂРёРјРµСЂРЅРѕ 0вЂ¦+50 В°C  
- **MTS4**: В±0.1 В°C РІ СѓР·РєРѕРј РґРёР°РїР°Р·РѕРЅРµ РєРѕРјРЅР°С‚РЅРѕР№ С‚РµРјРїРµСЂР°С‚СѓСЂС‹ (СЃРј. РґР°С‚Р°С€РёС‚)  
- **MTS4B**: С‚РёРїРёС‡РЅРѕ В±0.5 В°C РІ С€РёСЂРѕРєРѕРј СЂР°Р±РѕС‡РµРј РґРёР°РїР°Р·РѕРЅРµ  

Р’РЅРµ В«РѕРєРЅР° РІС‹СЃРѕРєРѕР№ С‚РѕС‡РЅРѕСЃС‚РёВ» РїРѕРіСЂРµС€РЅРѕСЃС‚СЊ РѕР±С‹С‡РЅРѕ В±0.5вЂ¦1.0 В°C  
(С‚РѕС‡РЅС‹Рµ Р·РЅР°С‡РµРЅРёСЏ СЃРј. РІ РґРѕРєСѓРјРµРЅС‚Р°С†РёРё РїСЂРѕРёР·РІРѕРґРёС‚РµР»СЏ).

РђРїРїР°СЂР°С‚РЅРѕРµ СѓСЃСЂРµРґРЅРµРЅРёРµ:

- `AVG_1`, `AVG_8`, `AVG_16`, `AVG_32`

Р”РѕРїРѕР»РЅРёС‚РµР»СЊРЅРѕ РјРѕР¶РЅРѕ РґРµР»Р°С‚СЊ С†РёС„СЂРѕРІРѕРµ СѓСЃСЂРµРґРЅРµРЅРёРµ РІ РјРёРєСЂРѕРєРѕРЅС‚СЂРѕР»Р»РµСЂРµ  
(РїСЂРёРјРµСЂ вЂ” РјРµС‚РµРѕСЃС‚Р°РЅС†РёСЏ).

### Р РµР¶РёРјС‹ РёР·РјРµСЂРµРЅРёСЏ

- **Single-shot (РѕРґРёРЅРѕС‡РЅРѕРµ РёР·РјРµСЂРµРЅРёРµ)**  
  Р§РёРї РїРµСЂРµС…РѕРґРёС‚ РІ РѕР¶РёРґР°РЅРёРµ, РєР°Р¶РґРѕРµ РёР·РјРµСЂРµРЅРёРµ Р·Р°РїСѓСЃРєР°РµС‚СЃСЏ РѕС‚РґРµР»СЊРЅРѕР№ РєРѕРјР°РЅРґРѕР№.  
  РњРёРЅРёРјР°Р»СЊРЅС‹Р№ СЃР°РјРѕРЅР°РіСЂРµРІ, РёРґРµР°Р»СЊРЅРѕ РґР»СЏ РјРµС‚РµРѕСЃС‚Р°РЅС†РёР№ Рё Р°РІС‚РѕРЅРѕРјРЅС‹С… СѓСЃС‚СЂРѕР№СЃС‚РІ.

- **Continuous (РЅРµРїСЂРµСЂС‹РІРЅС‹Р№)**  
  Р§РёРї РёР·РјРµСЂСЏРµС‚ РїРµСЂРёРѕРґРёС‡РµСЃРєРё СЃ Р·Р°РґР°РЅРЅРѕР№ С‡Р°СЃС‚РѕС‚РѕР№ `MPS_xHz`.

- **Stop**  
  РР·РјРµСЂРµРЅРёСЏ РѕСЃС‚Р°РЅРѕРІР»РµРЅС‹, С‡РёРї СЃРїРёС‚.

Р РµР¶РёРјС‹ Р·Р°РґР°СЋС‚СЃСЏ С‡РµСЂРµР· `setMode()` Рё `setConfig()`.

### CRC Рё С†РµР»РѕСЃС‚РЅРѕСЃС‚СЊ РґР°РЅРЅС‹С…

CRC8 РёСЃРїРѕР»СЊР·СѓРµС‚СЃСЏ РґР»СЏ:

- С‚РµРјРїРµСЂР°С‚СѓСЂС‹: Р±Р°Р№С‚С‹ `Temp_Lsb/Msb + Crc_temp`;
- РѕР±Р»Р°СЃС‚Рё `scratch` (0x03вЂ“0x0A + `Crc_Scratch`);
- РѕР±Р»Р°СЃС‚Рё `scratch_ext` (0x0CвЂ“0x15 + `Crc_Scratch_Ext`).

Р’С‹СЃРѕРєРѕСѓСЂРѕРІРЅРµРІС‹Рµ РјРµС‚РѕРґС‹:

- `readTemperatureCrc(...)`
- `readTemperatureRawWithCrc(...)`
- `readScratch(...)`
- `readScratchExt(...)`

### РџРѕСЂРѕРіРё, Р°Р»Р°СЂРјС‹, heater, EEPROM

- РџСЂРѕРіСЂР°РјРјРёСЂСѓРµРјС‹Рµ РїРѕСЂРѕРіРё `TH / TL` (РІ В°C, РїРµСЂРµСЃС‡С‘С‚ РІ raw РІС‹РїРѕР»РЅСЏРµС‚СЃСЏ Р±РёР±Р»РёРѕС‚РµРєРѕР№).
- Р РµР¶РёРјС‹ `Alert_Mode`:
  - `HIGH_TH_LOW_CLEAR` вЂ” Р°РІР°СЂРёСЏ РїСЂРё РїСЂРµРІС‹С€РµРЅРёРё TH, СЃР±СЂРѕСЃ РЅРёР¶Рµ TL;
  - `HIGH_TH_LOW_ALARM` вЂ” Р°РІР°СЂРёСЏ РїСЂРё РІС‹С…РѕРґРµ Р·Р° РґРёР°РїР°Р·РѕРЅ TLвЂ“TH.
- РЎС‚Р°С‚СѓСЃРЅС‹Р№ СЂРµРіРёСЃС‚СЂ `Status`:
  - С„Р»Р°РіРё HIGH/LOW alarm, BUSY, EE_BUSY, HEATER, TLв‰ҐTH Рё РґСЂ.
- Р’СЃС‚СЂРѕРµРЅРЅС‹Р№ heater (РїРѕРґРѕРіСЂРµРІР°С‚РµР»СЊ):
  - Р·Р°С‰РёС‚Р° РѕС‚ РєРѕРЅРґРµРЅСЃР°С‚Р°,
  - СЃР°РјРѕС‚РµСЃС‚ (РїРѕРґРЅСЏС‚РёРµ С‚РµРјРїРµСЂР°С‚СѓСЂС‹ РїРѕ РєРѕРјР°РЅРґРµ).
- Р”Рѕ 10 user-СЂРµРіРёСЃС‚СЂРѕРІ.
- РљРѕРјР°РЅРґС‹ EВІPROM:
  - `copy`, `recall`, `write`, `soft reset`.

---

## РџРѕРґРґРµСЂР¶РёРІР°РµРјС‹Рµ РґР°С‚С‡РёРєРё

РЎРµРјРµР№СЃС‚РІРѕ **MTS4**:

| РњРѕРґРµР»СЊ | РћРєРЅРѕ РјР°РєСЃРёРјР°Р»СЊРЅРѕР№ С‚РѕС‡РЅРѕСЃС‚Рё (С‚РёРїРёС‡РЅРѕ) | РўРёРїРѕРІР°СЏ С‚РѕС‡РЅРѕСЃС‚СЊ РІРЅСѓС‚СЂРё РѕРєРЅР° | РђРґСЂРµСЃ (РѕР±С‹С‡РЅРѕ) |
|--------|--------------------------------------|------------------------------|----------------|
| MTS4   | СѓР·РєРѕРµ РѕРєРЅРѕ РІРѕРєСЂСѓРі РєРѕРјРЅР°С‚РЅРѕР№ Р·РѕРЅС‹    | РґРѕ В±0.1 В°C                   | 0x41           |
| MTS4Z  | РѕС‚ 0 РґРѕ +50 В°C                       | РґРѕ В±0.1 В°C                   | 0x41           |
| MTS4P  | РѕС‚ в€’25 РґРѕ +25 В°C                     | РґРѕ В±0.1 В°C                   | 0x41           |
| MTS4B  | С€РёСЂРѕРєРёР№ РґРёР°РїР°Р·РѕРЅ                     | РґРѕ В±0.5 В°C                   | 0x41           |

РћСЃРѕР±РµРЅРЅРѕ СѓРґРѕР±РµРЅ РјРѕРґСѓР»СЊ **MTS4P+T4** вЂ” РіРѕС‚РѕРІР°СЏ РїР»Р°С‚РєР° РґР°С‚С‡РёРєР° РґР»СЏ Р±С‹СЃС‚СЂРѕРіРѕ РїРѕРґРєР»СЋС‡РµРЅРёСЏ Рє ESP8266/ESP32.

---

## РџРѕРґРґРµСЂР¶РёРІР°РµРјС‹Рµ РїР»Р°С‚С„РѕСЂРјС‹

- **ESP8266** (NodeMCU, Wemos D1 mini Рё Р°РЅР°Р»РѕРіРё)
- **ESP32** (DevKitC, NodeMCU-32S Рё С‚. Рї.)
- **Arduino AVR** (Uno, Nano, Mega, Pro Mini)
- Р›СЋР±Р°СЏ РїР»Р°С‚Р° СЃ РїРѕРґРґРµСЂР¶РєРѕР№ `TwoWire` (IВІC)

РСЃРїРѕР»СЊР·РѕРІР°РЅРёРµ Р»СЋР±РѕР№ IВІC-С€РёРЅС‹:

```cpp
#include <Wire.h>
#include "MTS4x.h"

MTS4X sensor1(0x41, Wire);    // РѕСЃРЅРѕРІРЅР°СЏ С€РёРЅР°
// MTS4X sensor2(0x42, Wire1); // РїСЂРё РЅР°Р»РёС‡РёРё РІС‚РѕСЂРѕР№ С€РёРЅС‹ Wire1

